<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>PromptCanvas</title>
        <link rel="stylesheet" href="popup.css" />
    </head>
    <body>
        <div class="popup-container">
            <header class="popup-header">
                <h1 class="popup-title">
                    <span class="logo">📝</span>
                    PromptCanvas
                </h1>
                <button class="btn-icon" id="settingsBtn" title="설정">
                    ⚙️
                </button>
            </header>

            <main class="popup-main">
                <!-- Template List View -->
                <section id="templateListView" class="view active">
                    <div class="search-bar">
                        <input
                            type="text"
                            id="searchInput"
                            placeholder="템플릿 검색..."
                            class="search-input"
                        />
                    </div>

                    <div class="template-list" id="templateList">
                        <!-- Templates will be inserted here -->
                    </div>

                    <button
                        class="btn btn-primary btn-full"
                        id="newTemplateBtn"
                    >
                        <span>+</span> 새 템플릿 만들기
                    </button>
                </section>

                <!-- Template Editor View -->
                <section id="templateEditView" class="view">
                    <div class="editor-header">
                        <button class="btn-icon" id="backBtn">←</button>
                        <h2 class="editor-title" id="editorTitle">새 템플릿</h2>
                    </div>

                    <form id="templateForm" class="template-form">
                        <div class="form-group">
                            <label for="templateName">템플릿 이름</label>
                            <input
                                type="text"
                                id="templateName"
                                placeholder="예: 흥부전 이미지 프롬프트"
                                required
                            />
                        </div>

                        <div class="form-group">
                            <label for="templateTrigger">트리거 키워드</label>
                            <input
                                type="text"
                                id="templateTrigger"
                                placeholder="예: /heungbu"
                                required
                            />
                            <span class="hint"
                                >Space 또는 Tab 키로 트리거됩니다</span
                            >
                        </div>

                        <div class="form-group">
                            <label for="templateJson">
                                템플릿 JSON
                                <button
                                    type="button"
                                    class="btn-link"
                                    id="helpBtn"
                                >
                                    문법 도움말
                                </button>
                            </label>
                            <textarea
                                id="templateJson"
                                rows="12"
                                placeholder='예:
{
  "name": "$input:이름을 입력하세요",
  "type": "$select:옵션1|옵션2|옵션3",
  "items": "$array:itemSchema",
  "$schemas": {
    "itemSchema": {
      "title": "$input:제목"
    }
  }
}'
                            ></textarea>
                            <span
                                class="hint json-status"
                                id="jsonStatus"
                            ></span>
                        </div>

                        <div class="form-actions">
                            <button
                                type="button"
                                class="btn btn-secondary"
                                id="cancelBtn"
                            >
                                취소
                            </button>
                            <button
                                type="button"
                                class="btn btn-danger"
                                id="deleteBtn"
                                style="display: none"
                            >
                                삭제
                            </button>
                            <button type="submit" class="btn btn-primary">
                                저장
                            </button>
                        </div>
                    </form>
                </section>

                <!-- Help View -->
                <section id="helpView" class="view">
                    <div class="editor-header">
                        <button class="btn-icon" id="helpBackBtn">←</button>
                        <h2 class="editor-title">문법 도움말</h2>
                    </div>

                    <div class="help-content">
                        <h3>마커 문법</h3>

                        <div class="help-item">
                            <code>$input:라벨</code>
                            <p>텍스트 입력 필드를 생성합니다.</p>
                            <pre>"name": "$input:이름을 입력하세요"</pre>
                        </div>

                        <div class="help-item">
                            <code>$select:옵션1|옵션2|옵션3</code>
                            <p>
                                선택 또는 직접 입력이 가능한 필드를 생성합니다. 첫 번째 옵션이
                                기본값입니다.
                            </p>
                            <pre>"mood": "$select:밝은|어두운|중립"</pre>
                        </div>

                        <div class="help-item">
                            <code>$array:스키마명</code>
                            <p>동적으로 추가/삭제 가능한 배열을 생성합니다.</p>
                            <pre>
"characters": "$array:charItem",
"$schemas": {
  "charItem": {
    "name": "$input:캐릭터 이름",
    "role": "$select:주인공|조연|배경"
  }
}</pre
                            >
                        </div>

                        <div class="help-item">
                            <code>일반 문자열</code>
                            <p>편집 불가능한 고정 값입니다.</p>
                            <pre>"style": "Korean watercolor"</pre>
                        </div>
                    </div>
                </section>
            </main>
        </div>

        <script src="../dist/popup.js" type="module"></script>
    </body>
</html>
